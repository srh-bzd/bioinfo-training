{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Bienvenue sur le site","text":"<p>La bioinformatique est un domaine dynamique et essentiel \u00e0 l'\u00e8re des donn\u00e9es massives. En combinant l'informatique, les math\u00e9matiques et la biologie, elle permet d'analyser des donn\u00e9es biologiques complexes, comme les s\u00e9quences g\u00e9n\u00e9tiques ou les prot\u00e9ines, pour faire avancer la recherche scientifique et m\u00e9dicale. </p> <p>Explorez, Apprenez et Pratiquez</p> <p>Le site offre des cours, des connaissances et des analyses sur une vari\u00e9t\u00e9 de sujets bioinformatiques. L'objectif est de rendre la bioinformatique accessible et engageante.</p>"},{"location":"about/","title":"\u00c0 propos","text":"<p>Salut \u00e0 toi qui me lis !</p> <p>Je suis Sarah Bouzidi, ing\u00e9nieure en Bioinformatique, et j'ai cr\u00e9\u00e9 ce site pour partager et garder une trace des exp\u00e9riences et r\u00e9alisations qui ont marqu\u00e9 mon parcours professionnel.</p> <p>\u00c0 travers mes exp\u00e9riences, mes projets et mes apprentissages, j'ai accumul\u00e9 des connaissances et des comp\u00e9tences que je souhaitais organiser et mettre en valeur. Ce site est donc \u00e0 la fois un journal de bord et une vitrine de mon travail. </p> <p>Merci de ta visite et bonne exploration !</p>"},{"location":"knowledge/knowledge/","title":"Vue d'ensemble","text":"<p>Dans cette section, vous trouverez des explications sur des concepts cl\u00e9s, des outils, des bases de donn\u00e9es ou des fichiers couramment utilis\u00e9s en bioinformatique. Elle vous permettra de mieux comprendre les essentiels \u00e0 l'analyse bioinformatique.</p>"},{"location":"knowledge/databases/refseq/","title":"RefSeq","text":""},{"location":"knowledge/databases/refseq/#a-propos","title":"A propos","text":"<p>RefSeq est la base de donn\u00e9es NCBI de s\u00e9quences de r\u00e9f\u00e9rence ; un ensemble organis\u00e9 et non redondant comprenant des contigs d'ADN g\u00e9nomique, des ARNm et des prot\u00e9ines pour des g\u00e8nes connus, ainsi que des chromosomes entiers.</p>"},{"location":"knowledge/databases/refseq/#accession-numbers-et-types-de-molecules","title":"Accession numbers et types de mol\u00e9cules","text":"<p>Les entr\u00e9es RefSeq sont similaires au format d'entr\u00e9e de GenBank. Attribuer une nouvelle entr\u00e9e RefSeq inclus un unique pr\u00e9fixe d'accession suivi d'un underscore. Le pr\u00e9fixe d'accession RefSeq a une signification implicite en termes de type de mol\u00e9cule qu'il repr\u00e9sente.  Voici tous les pr\u00e9fixes d'accession RefSeq et le type de mol\u00e9cule associ\u00e9 provenant de la Table 1 du Chapitre 18 The Reference Sequence (RefSeq) Database retrouv\u00e9 dans The NCBI Handbook</p> Accession prefix Molecule type Comment AC_ Genomic Complete genomic molecule, usually alternate assembly NC_ Genomic Complete genomic molecule, usually reference assembly NG_ Genomic Incomplete genomic region NT_ Genomic Contig or scaffold, clone-based or WGSa NW_ Genomic Contig or scaffold, primarily WGSa NZ_ Genomic Complete genomes and unfinished WGS data NM_ mRNA Protein-coding transcripts (usually curated) NR_ RNA Non-protein-coding transcripts XM_ mRNA Predicted model protein-coding transcript XR_ RNA Predicted model non-protein-coding transcript AP_ Protein Annotated on AC_ alternate assembly NP_ Protein Associated with an NM_ or NC_ accession YP_ Protein Annotated on genomic molecules without an instantiated transcript record XP_ Protein Predicted model, associated with an XM_ accession WP_ Protein Non-redundant across multiple strains and species"},{"location":"knowledge/databases/refseq/#code-status","title":"Code status","text":"<p>Chaque enregistrement a un COMMENT, indiquant le niveau de conservation qu'il a re\u00e7u et l'attribution du groupe collaborateur.  Ainsi, un enregistrement RefSeq peut \u00eatre une copie essentiellement inchang\u00e9e et valid\u00e9e de la soumission originale de l'INSDC, ou inclure des informations mises \u00e0 jour ou suppl\u00e9mentaires fournies par des collaborateurs ou le personnel du NCBI. Voici tous les codes status RefSeq provenant de la Table 2 du Chapitre 18 The Reference Sequence (RefSeq) Database retrouv\u00e9 dans The NCBI Handbook</p> Code Description MODEL The RefSeq record is provided by the NCBI Genome Annotation pipeline and is not subject to individual review or revision between annotation runs. INFERRED The RefSeq record has been predicted by genome sequence analysis, but it is not  yet supported by experimental evidence. The record may be partially  supported by homology data. PREDICTED The RefSeq record has not yet been subject to individual review, and some aspect of the RefSeq record is predicted. PROVISIONAL The RefSeq record has not yet been subject to individual review. The initial  sequence-to-gene association has been established by outside  collaborators or NCBI staff. REVIEWED The RefSeq record has been reviewed by NCBI staff or by a collaborator. The NCBI review process includes assessing available sequence data and the literature. Some RefSeq records may incorporate expanded sequence and annotation information. VALIDATED The RefSeq record has undergone an initial review to provide the preferred  sequence standard. The record has not yet been subject to final review  at which time additional functional information may be provided. WGS The RefSeq record is provided to represent a collection of whole genome shotgun  sequences. These records are not subject to individual review or  revisions between genome updates."},{"location":"knowledge/references/human-annotations/","title":"Les annotations du g\u00e9nome humain","text":"<p>Le GTF humain (General Feature Format) est un fichier contenant des annotations g\u00e9nomiques sp\u00e9cifiques au g\u00e9nome humain. Ces fichiers fournissent des informations d\u00e9taill\u00e9es sur la localisation des g\u00e8nes, des exons, des introns et d'autres \u00e9l\u00e9ments fonctionnels dans le g\u00e9nome humain. Le GTF est identique \u00e0 la version 2 du GFF (General Feature Format). La diff\u00e9rence entre le GTF et le GFF est le fait que le GTF contient les types d'int\u00e9r\u00eats pour de la transcriptomique.</p> <p>Le fichier des annotations du g\u00e9nome assembl\u00e9 GRCh38 est disponible \u00e0 l'adresse https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/ sous le nom de fichier GCF_000001405.40_GRCh38.p14_genomic.gtf.gz.</p>"},{"location":"knowledge/references/human-annotations/#la-constitution-du-fichier","title":"La constitution du fichier","text":"<p>Contrairement aux transcriptomes et g\u00e9nomes de r\u00e9f\u00e9rence, le fichier GTF n'est pas constitu\u00e9 d'identifiants et de s\u00e9quences mais de colonnes :</p> <ul> <li>seqid, l'identifiant de la s\u00e9quence o\u00f9 se trouve la fonctionnalit\u00e9</li> <li>source, l'algorithme ou la proc\u00e9dure qui a g\u00e9n\u00e9r\u00e9 la fonctionnalit\u00e9. Il s'agit g\u00e9n\u00e9ralement du nom d'un logiciel ou d'une base de donn\u00e9es</li> <li>type, le nom du type de fonctionnalit\u00e9 comme \"g\u00e8ne\" ou \"exon\"</li> <li>start, position g\u00e9nomique de d\u00e9part de la fonctionnalit\u00e9</li> <li>end, position g\u00e9nomique de fin </li> <li>score, valeur num\u00e9rique qui indique g\u00e9n\u00e9ralement la confiance de la source dans l'entit\u00e9 annot\u00e9e. Une valeur de \".\" (un point) est utilis\u00e9 pour d\u00e9finir une valeur nulle</li> <li>strand, indique le sens avec \"+\" (positif ou 5'-&gt;3'), \"-\", (n\u00e9gatif ou 3'-&gt;5'), \".\" (ind\u00e9termin\u00e9), ou \"?\" pour inconnus</li> <li>phase, la phase du CDS qui peut \u00eatre 0, 1, 2 ou \".\"</li> <li>attributes, attributs suppl\u00e9mentaires au format cl\u00e9-valeur (ex. : gene_id, gene_name)</li> </ul>"},{"location":"knowledge/references/human-annotations/#les-types-presents-dans-le-gtf","title":"Les types pr\u00e9sents dans le GTF","text":"<p>Pour voir tous les types pr\u00e9sents avec leurs comptes, il faut lancer cette commande sur le fichier GTF d\u00e9zipp\u00e9 :</p> <pre><code>awk '{a[$3]++}END{for ( i in a) print i\" \"a[i]}' GCF_000001405.40_GRCh38.p14_genomic.gtf\n</code></pre> <p>Voici les informations que nous obtenons :</p> <p><pre><code>Genomic 22045\n 5\nRefSeq 1\nexon 2298755\nCDS 1837053\ngene 50329\nstart_codon 144663\nGenomic%2Ccmsearch 1\nstop_codon 144508\ntranscript 200311\n</code></pre> A titre informatif, voil\u00e0 ce que nous pouvons en dire :</p> <ul> <li>Genomic (22045) : Ce type fait g\u00e9n\u00e9ralement r\u00e9f\u00e9rence \u00e0 des \u00e9l\u00e9ments g\u00e9nomiques sans sp\u00e9cification claire (par exemple, des r\u00e9gions non annot\u00e9es ou des segments de s\u00e9quences g\u00e9nomiques).</li> <li>RefSeq (1) : Ce type fait r\u00e9f\u00e9rence \u00e0 des \u00e9l\u00e9ments sp\u00e9cifiquement annot\u00e9s selon le syst\u00e8me RefSeq, qui est une base de donn\u00e9es d'annotations g\u00e9nomiques maintenue par le NCBI (National Center for Biotechnology Information).</li> <li>exon (2298755) : Les exons sont les segments de g\u00e8nes qui sont exprim\u00e9s et qui sont traduits en prot\u00e9ines. Cette annotation indique combien d'exons sont pr\u00e9sents dans le fichier.</li> <li>CDS (1837053) : CDS signifie Coding Sequence. Cela repr\u00e9sente les r\u00e9gions du g\u00e8ne qui sont traduites en prot\u00e9ine. Cette annotation indique combien de CDS sont pr\u00e9sents dans le fichier.</li> <li>gene (50329) : Cette annotation indique le nombre de g\u00e8nes identifi\u00e9s dans le fichier GTF. Chaque g\u00e8ne est g\u00e9n\u00e9ralement associ\u00e9 \u00e0 plusieurs exons et \u00e9ventuellement \u00e0 plusieurs transcrits.</li> <li>start_codon (144663) : Cette annotation repr\u00e9sente le nombre de codons de d\u00e9part (ATG) pr\u00e9sents dans le fichier. Un codon de d\u00e9part marque le d\u00e9but de la traduction d'un ARNm en prot\u00e9ine.</li> <li>stop_codon (144508) : Cette annotation repr\u00e9sente le nombre de codons d'arr\u00eat pr\u00e9sents dans le fichier. Un codon d'arr\u00eat marque la fin de la traduction.</li> <li>transcript (200311) : Cela indique le nombre de transcrits diff\u00e9rents pr\u00e9sents dans le fichier GTF. Un transcrit est le produit de la transcription d'un g\u00e8ne, qui peut inclure des variantes d'\u00e9pissage.</li> <li>Genomic%2Ccmsearch (1) : Ce type semble \u00eatre une erreur ou une annotation non standard. %2C est une repr\u00e9sentation URL pour une virgule, ce qui peut indiquer un probl\u00e8me de formatage ou une entr\u00e9e non intentionnelle.</li> </ul>"},{"location":"knowledge/references/human-genome/","title":"Le g\u00e9nome humain","text":"<p>Le g\u00e9nome humain de r\u00e9f\u00e9rence est une s\u00e9quence de l\u2019ADN humain qui sert de mod\u00e8le standard pour repr\u00e9senter l'ensemble du g\u00e9nome humain. Il s'agit d'une carte g\u00e9nomique unifi\u00e9e qui combine les s\u00e9quences d'ADN provenant de plusieurs individus, utilis\u00e9e pour la recherche, l'analyse clinique et la comparaison g\u00e9n\u00e9tique.</p> <p>La derni\u00e8re version du g\u00e9nome de r\u00e9f\u00e9rence humain \u00e0 ce jour est GRCh38.p14. Il est possible de la t\u00e9l\u00e9charger directement \u00e0 l'adresse https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/ sous le nom de fichier GCF_000001405.40_GRCh38.p14_genomic.fna.gz.</p> <p>Nous allons voir ensemble les informations sur ce g\u00e9nome de r\u00e9f\u00e9rence.</p>"},{"location":"knowledge/references/human-genome/#le-nom-du-fichier","title":"Le nom du fichier","text":"<p>Nous allons d\u00e9cortiquer le nom de fichier du g\u00e9nome : </p> <ul> <li>GRCh38 (Genome Reference Consortium Human Build 38) correspond \u00e0 la version du g\u00e9nome humain assembl\u00e9</li> <li>p14 (patch release 14) correspond \u00e0 la version 14 du patch, soit \u00e0 la 14\u00e8me correction</li> <li>GCF_000001405.40 est l'accession RefSeq (l'\u00e9quivalent en accession GenBank est GCA_000001405.29)</li> <li>_genomic.fna.gz correspond au format FASTA comprennant les ADN pr\u00e9sent dans le g\u00e9nome</li> </ul>"},{"location":"knowledge/references/human-genome/#accessions-number","title":"Accessions number","text":"<p>Quand l'on regarde les identifiants des s\u00e9quences FASTA du g\u00e9nome de r\u00e9f\u00e9rence, nous pouvons constater que les num\u00e9ros accessions d\u00e9butent par NT, NC et NW. Les ids RefSeq d\u00e9butant par N sont des Known RefSeq. Ainsi, ces s\u00e9quences sont revues manuellement par des membres du NCBI ou des collaborateur.  Sinon, si l'on se r\u00e9f\u00e8re \u00e0 la Table 1 du Chapter 18, The Reference Sequence (RefSeq) Database, nous pouvont voir : </p> <p>NC_ | Genomic | Complete genomic molecule, usually reference assembly</p> <p>NT_   | Genomic   | Contig or scaffold, clone-based or WGS</p> <p>NW_   | Genomic   | Contig or scaffold, primarily WGS</p> <p>Prenons des exemples d'identifiants dans le fichier du g\u00e9nome de r\u00e9f\u00e9rence :  <pre><code>&gt;NC_000001.11 Homo sapiens chromosome 1, GRCh38.p14 Primary Assembly\n&gt;NC_000009.12 Homo sapiens chromosome 9, GRCh38.p14 Primary Assembly\n\n&gt;NT_187361.1 Homo sapiens chromosome 1 unlocalized genomic scaffold, GRCh38.p14 Primary Assembly HSCHR1_CTG1_UNLOCALIZED\n&gt;NT_187372.1 Homo sapiens chromosome 9 unlocalized genomic scaffold, GRCh38.p14 Primary Assembly HSCHR9_UNLOCALIZED_CTG1\n\n&gt;NW_012132914.1 Homo sapiens chromosome 1 genomic patch of type FIX, GRCh38.p14 PATCHES HG1342_HG2282_PATCH\n&gt;NW_013171804.1 Homo sapiens chromosome 9 genomic patch of type NOVEL, GRCh38.p14 PATCHES HSCHR9_1_CTG6\n</code></pre> Nous pouvons constater avec ces exemples que les identifiants d\u00e9butant par NC_ correspondent \u00e0 des chromosomes</p>"},{"location":"knowledge/references/human-genome/#quantification-des-sequences-presentes","title":"Quantification des s\u00e9quences pr\u00e9sentes","text":"<p>Nous pouvons voir que dans le fichier FASTA du g\u00e9nome de r\u00e9f\u00e9rence il y a 705 s\u00e9quences dont :</p> <ul> <li>25 NC_ soit 24 chromosomes + mitochondrie</li> <li>355 NT_, unlocalized genomic scaffold, assembl\u00e9es mais leur emplacement pr\u00e9cis n'est pas d\u00e9termin\u00e9 avec certitude</li> <li>325 NW_, genomic scaffold, souvent utilis\u00e9 comme r\u00e9vision ou affinage de r\u00e9gion</li> </ul> <p>Ce qui comprends environ : </p> <ul> <li>20000 \u00e0 21000 g\u00e8nes codant pour des prot\u00e9ines</li> <li>10000 \u00e0 20000 g\u00e8nes non codants (ARN non codants, microARN, etc.) </li> </ul>"},{"location":"knowledge/references/human-transcriptome/","title":"Le transcriptome humain","text":"<p>Le transcriptome de r\u00e9f\u00e9rence humain est une repr\u00e9sentation compl\u00e8te de tous les transcrits (ARN) exprim\u00e9s dans les cellules humaines \u00e0 un moment donn\u00e9. Contrairement au g\u00e9nome, qui est fixe et identique dans toutes les cellules d'un individu, le transcriptome varie en fonction du type cellulaire, du stade de d\u00e9veloppement, des conditions environnementales, et des stimuli externes. Il constitue donc un instantan\u00e9 dynamique de l'expression g\u00e9nique dans une cellule ou un tissu.</p> <p>La derni\u00e8re version du transcriptome de r\u00e9f\u00e9rence humain \u00e0 ce jour est GRCh38.p14. Il est possible de la t\u00e9l\u00e9charger directement \u00e0 l'adresse https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/ sous le nom de fichier GCF_000001405.40_GRCh38.p14_rna.fna.gz.</p> <p>Nous allons voir ensemble les informations sur ce transcriptome de r\u00e9f\u00e9rence humain.</p>"},{"location":"knowledge/references/human-transcriptome/#le-nom-du-fichier","title":"Le nom du fichier","text":"<p>Nous allons d\u00e9cortiquer le nom de fichier du transcriptome : </p> <ul> <li>GRCh38 (Genome Reference Consortium Human Build 38) correspond \u00e0 la version du g\u00e9nome humain assembl\u00e9</li> <li>p14 (patch release 14) correspond \u00e0 la version 14 du patch, soit \u00e0 la 14\u00e8me correction</li> <li>GCF_000001405.40 est l'accession RefSeq (l'\u00e9quivalent en accession GenBank est GCA_000001405.29)</li> <li>_rna.fna.gz correspond au format FASTA comprennant les ARN produits \u00e0 partir du g\u00e9nome</li> </ul>"},{"location":"knowledge/references/human-transcriptome/#accessions-number-et-status-code","title":"Accessions number et status code","text":"<p>Pour ce qui est de l'int\u00e9rieur du fichier, rien de changant par rapport \u00e0 un fichier FASTA classique. En revanche, on peut noter 4 types de num\u00e9ro d'accessions dans les ids (apr\u00e8s &gt; dans le fichier) : NM_, XM_, NR_ et XR_. Si l'on regarde la page RefSeq de l'annotation d'Homo sapiens, notamment le tableau Feature counts dans la section Gene and feature statistics, on peut retrouver les patterns d'ids dans mRNAs (pour NM et XM) et dans non-coding RNAs (pour NR et XR). </p> <p>Les ids d\u00e9butant par un X sont des Model RefSeq. Ce sont des s\u00e9quences produites de fa\u00e7on automatique par un pipeline.</p> <p>RNA and protein products that are generated by the eukaryotic genome annotation pipeline. These records use accession prefixes XM_, XR_, and XP_. (https://www.ncbi.nlm.nih.gov/refseq/about/)</p> <p>Les ids d\u00e9butant par un N sont des Known RefSeq. Ce sont des s\u00e9quences manuellement revues par des membres du NCBI ou des collaborateurs.</p> <p>RNA and protein products that are mainly derived from GenBank cDNA and EST data and are supported by the RefSeq eukaryotic curation group. These records use accession prefixes NM_, NR_, and NP_. (https://www.ncbi.nlm.nih.gov/refseq/about/)</p>"},{"location":"knowledge/references/human-transcriptome/#quantification-des-arns-presents","title":"Quantification des ARNs pr\u00e9sents","text":"<p>Comme nous l'avons vu pr\u00e9c\u00e9dement, nous avons 4 types d'accessions number correspondant \u00e0 des ARNm et \u00e0 des ARNnc. Voici le nombre de chacun d'entre eux dans le transcriptome de r\u00e9f\u00e9rence t\u00e9l\u00e9charg\u00e9. Les informations peuvent \u00eatre retrouv\u00e9es dans la table Feature counts de la page RefSeq de l'annotation d'Homo sapiens, notamment aux lignes mRNAs, non-coding RNAs et pseudo transcripts.</p> mRNAs : NM mRNAs : XM ncRNAs : NR ncRNAs : NR pseudo transcripts : NR pseudo transcripts : XR 67116 69065 21487 25697 1593 163 <p>Soit un total de :</p> <ul> <li>mRNAs : 136181</li> <li>ncRNAs : 47184</li> <li>pseudo transcripts : 1756</li> </ul>"},{"location":"knowledge/references/human-transcriptome/#les-isoformes","title":"Les isoformes","text":"<p>Dans le transcriptome de r\u00e9f\u00e9rence humain, les isoformes des ARN sont pr\u00e9sents.  Prenons le cas du g\u00e8ne MELK maternal embryonic leucine zipper kinase.  Lorsque l'on effectue une recherche de ce g\u00e8ne dans le fichier FASTA du transcriptome, on retrouve 53 s\u00e9quences de transcripts de mRNA pr\u00e9dits ou non et d'un ncRNA review </p> <pre><code>NM_001256685.2  Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 2, mRNA\nNM_001256687.2  Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 3, mRNA\nNM_001256688.2  Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 4, mRNA\nNM_001256689.2  Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 5, mRNA\nNM_001256690.2  Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 6, mRNA\nNM_001256691.2  Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 7, mRNA\nNM_001256692.2  Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 8, mRNA\nNM_001256693.2  Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 9, mRNA\nNM_014791.4 Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 1, mRNA\nNR_046337.2 Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant 10, non-coding RNA\nXM_011518076.3  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X2, mRNA\nXM_011518077.2  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X3, mRNA\nXM_011518080.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X4, mRNA\nXM_011518081.3  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X8, mRNA\nXM_011518082.3  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X7, mRNA\nXM_011518085.2  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X27, mRNA\nXM_047424166.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X1, mRNA\nXM_047424168.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X5, mRNA\nXM_047424169.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X6, mRNA\nXM_047424170.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X9, mRNA\nXM_047424171.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X10, mRNA\nXM_047424172.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X11, mRNA\nXM_047424173.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X12, mRNA\nXM_047424174.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X13, mRNA\nXM_047424176.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X14, mRNA\nXM_047424177.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X15, mRNA\nXM_047424178.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X16, mRNA\nXM_047424179.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X17, mRNA\nXM_047424180.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X18, mRNA\nXM_047424181.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X19, mRNA\nXM_047424182.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X20, mRNA\nXM_047424183.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X21, mRNA\nXM_047424184.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X22, mRNA\nXM_047424185.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X23, mRNA\nXM_047424186.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X24, mRNA\nXM_047424187.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X25, mRNA\nXM_047424188.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X26, mRNA\nXM_047424189.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X28, mRNA\nXM_047424191.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X29, mRNA\nXM_047424192.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X30, mRNA\nXM_047424193.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X31, mRNA\nXM_047424194.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X32, mRNA\nXM_047424195.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X33, mRNA\nXM_047424196.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X34, mRNA\nXM_047424197.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X35, mRNA\nXM_047424198.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X36, mRNA\nXM_047424199.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X37, mRNA\nXM_047424200.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X38, mRNA\nXM_047424202.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X39, mRNA\nXM_047424203.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X40, mRNA\nXM_047424204.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X41, mRNA\nXM_047424205.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X42, mRNA\nXM_047424206.1  PREDICTED: Homo sapiens maternal embryonic leucine zipper kinase (MELK), transcript variant X43, mRNA\n</code></pre> <p>Il est possible de visualiser cette liste de transcripts en allant dans la section  Genomic regions, transcripts, and products de la page NCBI du g\u00e8ne MELK. Attention, dans le menu d\u00e9roulant Genomic Sequence: il est important de bien prendre la r\u00e9f\u00e9rence GRCh38.p14.</p> <p></p>"},{"location":"knowledge/tools/assembly-bias/","title":"Compr\u00e9hension des biais d'assemblage","text":"<p>Lorsque l'on effectue un assemblage de novo genome guided avec un outil comme StringTie, il arrive que les r\u00e9sultats ne correspondent pas enti\u00e8rement aux attentes biologiques. </p> <p>Lors d'une analyse de transcrits issus d\u2019un assemblage, nous avons pu observer que tous les transcrits obtenus correspondaient \u00e0 une fusion de deux g\u00e8nes (shble et eGFP) m\u00eame si le niveau de couverture entre ceux-ci \u00e9tait tr\u00e8s in\u00e9gal. En effet, la couverture de shble \u00e9tait nettement plus \u00e9lev\u00e9e que celle de eGFP. </p> <p></p> <p>Qu'est-ce qui peut expliquer qu'aucun transcrit shble seul n'a \u00e9t\u00e9 identifi\u00e9, malgr\u00e9 sa forte couverture ? </p>"},{"location":"knowledge/tools/assembly-bias/#pourquoi-stringtie-fusionne-t-il-ces-transcrits","title":"Pourquoi StringTie fusionne-t-il ces transcrits ?","text":""},{"location":"knowledge/tools/assembly-bias/#un-modele-de-transcription-base-sur-la-continuite","title":"Un mod\u00e8le de transcription bas\u00e9 sur la continuit\u00e9","text":"<p>StringTie en genome guided utilise les alignements des lectures pour reconstruire les transcrits en favorisant les connexions entre r\u00e9gions. shble et eGFP \u00e9tant exprim\u00e9s \u00e0 partir d'un m\u00eame locus, car sur un plasmide, StringTie peut supposer qu\u2019ils forment un seul transcrit. Cela reste vrai m\u00eame si la couverture entre ces r\u00e9gions est in\u00e9gale. La pr\u00e9sence de lectures chevauchant les deux g\u00e8nes contribue \u00e0 cette fusion.</p>"},{"location":"knowledge/tools/assembly-bias/#faible-couverture-de-egfp","title":"Faible couverture de eGFP","text":"<p>Bien que la couverture de eGFP soit faible, elle semble suffisante pour \u00e9tablir un lien avec shble. StringTie ne discrimine pas les r\u00e9gions \u00e0 faible couverture si elles sont reli\u00e9es par des lectures contigu\u00ebs. Ainsi, tant qu\u2019une continuit\u00e9 existe dans les alignements, StringTie pr\u00e9f\u00e9rera reconstruire un transcrit complet plut\u00f4t que de s\u00e9parer les r\u00e9gions.</p>"},{"location":"knowledge/tools/assembly-bias/#parametres-de-stringtie","title":"Param\u00e8tres de StringTie","text":"<p>StringTie offre de nombreux param\u00e8tres configurables, mais certains d'entre eux peuvent accentuer le probl\u00e8me :</p> <ul> <li><code>-f</code> : ce param\u00e8tre contr\u00f4le la proportion minimale d'expression requise pour qu'un isoforme soit report\u00e9. Une valeur \u00e9lev\u00e9e peut favoriser les transcrits dominants (comme shble-eGFP) et exclure des formes minoritaires (comme shble seul)</li> <li><code>--rf / --fr</code> : ces param\u00e8tres permettent de renseigner le strandedness de la librairie. Un mauvais choix peut favoriser des d\u00e9fauts d'assemblage</li> </ul> <pre><code>-f &lt;0.0-1.0&gt;    Sets the minimum isoform abundance of the predicted transcripts as a fraction of the most abundant transcript assembled at a given locus. Lower abundance transcripts are often artifacts of incompletely spliced precursors of processed transcripts. Default: 0.01\n\n--rf    Assumes a stranded library fr-firststrand.\n\n--fr    Assumes a stranded library fr-secondstrand. \n</code></pre>"},{"location":"knowledge/tools/assembly-bias/#comment-explorer-et-resoudre-ce-probleme","title":"Comment explorer et r\u00e9soudre ce probl\u00e8me ?","text":""},{"location":"knowledge/tools/assembly-bias/#visualisation-des-alignements","title":"Visualisation des alignements","text":"<p>L\u2019analyse visuelle des alignements est un premier pas crucial. Les outils comme IGV permettent d\u2019observer si des lectures couvrent uniquement shble ou si elles sont toujours connect\u00e9es \u00e0 eGFP. Cela permet aussi d\u2019\u00e9valuer si les r\u00e9gions \u00e0 faible couverture de eGFP influencent l\u2019assemblage.</p>"},{"location":"knowledge/tools/assembly-bias/#ajustement-des-parametres-stringtie","title":"Ajustement des param\u00e8tres StringTie","text":"<p>Les param\u00e8tres de StringTie cit\u00e9s plus haut peuvent \u00eatre modifi\u00e9s pour explorer d'autres hypoth\u00e8ses :</p> <ul> <li>r\u00e9duire <code>-f</code> pour inclure des isoformes minoritaires (m\u00eame si d\u00e9j\u00e0 tr\u00e8s faible)</li> <li>s'assurer que le strandedness est renseign\u00e9 correctement</li> </ul>"},{"location":"knowledge/tools/assembly-bias/#assembler-differemment","title":"Assembler diff\u00e9remment","text":"<p>En compl\u00e9ment de StringTie, il peut \u00eatre utile d'utiliser d\u2019autres outils comme Trinity pour assembler les transcrits. Ces outils ont des algorithmes diff\u00e9rents et pourraient r\u00e9v\u00e9ler des transcrits absents dans les r\u00e9sultats de StringTie.</p>"},{"location":"knowledge/tools/assembly-bias/#limpact-de-la-biologie","title":"L'impact de la biologie","text":"<p>Il est important de se demander si l'absence de transcrits shble seul est une limite technique ou une r\u00e9alit\u00e9 biologique. Dans certains syst\u00e8mes, notamment avec des constructions artificielles comme des plasmides, tous les transcrits peuvent naturellement \u00eatre co-transcrits. Si tel est le cas, il n\u2019y aura biologiquement aucun shble isol\u00e9 m\u00eame si la couverture sugg\u00e8re qu\u2019il pourrait exister. C'est l\u00e0 o\u00f9 il est int\u00e9ressant de compl\u00e9ter la bioinformatique par la paillasse.</p>"},{"location":"knowledge/tools/rnaseq-strandedness/","title":"L'inf\u00e9rence du strandedness en RNAseq","text":"<p>Les librairies RNAseq sont pr\u00e9par\u00e9es de plusieurs fa\u00e7on ce qui fait que les lectures de s\u00e9quen\u00e7age peuvent pr\u00e9senter diverses caract\u00e9ristiques. Les lectures pr\u00e9sentent ainsi :</p> <p>une orientation</p> <ul> <li>I = inward, vers l'int\u00e9rieur (fr)</li> <li>O = outward, vers l'ext\u00e9rieur (rf) </li> <li>M = matching (ff)</li> </ul> <p>la sp\u00e9cificit\u00e9 de librairie</p> <ul> <li>S = stranded</li> <li>U = unstranded</li> </ul> <p>la sp\u00e9cificit\u00e9 de brin (seulement dans le cas d'une librairie stranded)</p> <ul> <li>F = forward, dans le cas o\u00f9 les lectures du fichier 1 d\u00e9rivent du brin ADN sens et sont donc les copies du brin anti-sens (secondstrand)</li> <li>R = reverse, dans le cas o\u00f9 les lectures du fichier 1 d\u00e9rivent du brin ADN anti-sens et sont donc les copies du brin sens (firststrand)</li> </ul> <p> (voir la page de documentation de Salmon)</p> <p>A titre d'exemple, une librairie ISR indique que :</p> <ul> <li>les lectures pair\u00e9es vont vers l'int\u00e9rieur l'une de l'autre, soit une polarit\u00e9 fr</li> <li>les lectures sont strand sp\u00e9cifiques</li> <li>la lecture 1 est reverse, elle d\u00e9rive donc du brin ADN anti-sens et est donc la copie du brin sens. La sp\u00e9cifit\u00e9 de brin est firststrand</li> </ul> <p>Les outils RNAseq d'assemblage et de comptage int\u00e8grent ces informations via un param\u00e8tre. Une utilisation incorrecte de ce param\u00e8tre peut avoir un impact sur le r\u00e9sultat des analyses RNA-Seq, notamment la perte de lectures lors d'alignement contre une r\u00e9f\u00e9rence et l'obtention de faux positifs et n\u00e9gatifs dans les r\u00e9sultats d'expression diff\u00e9rentielle.</p> <p>Selon l'outil utilis\u00e9, voici l'option \u00e0 renseigner (https://rnabio.org/module-09-appendix/0009/12/01/StrandSettings/) : </p> <p></p>"},{"location":"training/training/","title":"Vue d'ensemble","text":"<p>Dans cette section, vous trouverez des formations d\u00e9taill\u00e9es et des analyses compl\u00e8tes pour vous accompagner dans vos travaux bioinformatiques. Cette section est con\u00e7ue pour vous guider \u00e0 travers les diff\u00e9rentes \u00e9tapes de l'analyse de donn\u00e9es biologiques, en utilisant des outils et des m\u00e9thodes.</p>"},{"location":"training/analysis/rnaseq-training/","title":"L'analyse RNAseq - Tutoriel","text":"<p>Dans cette exemple d'analyse RNAseq, nous allons utiliser des donn\u00e9es d'expression short-reads de cellule humaine HEK293 accessibles sous le BioProject PRJNA753061.</p>"},{"location":"training/analysis/rnaseq-training/#1-telechargement-des-donnees-dinterets-les-lectures-arn","title":"1. T\u00e9l\u00e9chargement des donn\u00e9es d'int\u00e9r\u00eats : les lectures ARN","text":"<p>Pour pouvoir t\u00e9l\u00e9charger les lectures, nous allons utiliser SRA Toolkit. Mais en premier, pour faciliter \"l'automatisation\" du t\u00e9l\u00e9chargement des donn\u00e9es, nous allons r\u00e9cup\u00e9rer la liste des accessions des SRA. </p>"},{"location":"training/analysis/rnaseq-training/#11-recuperation-des-noms-sra","title":"1.1. R\u00e9cup\u00e9ration des noms SRA","text":"<ul> <li>Aller \u00e0 l'adresse du BioProject</li> <li>Cliquer sur SRA dans le menu Related information ou dans le tableau Project Data cliquer sur le Number of Links correspondant au nombre total de SRA</li> <li>Dans le menu d\u00e9roulant Send to choisir File puis Accession List et valider avec Create File</li> </ul> <p>Un fichier au nom SraAccList.csv a \u00e9t\u00e9 cr\u00e9\u00e9.</p>"},{"location":"training/analysis/rnaseq-training/#12-telechargement-des-sra","title":"1.2. T\u00e9l\u00e9chargement des SRA","text":"<ul> <li>Installer SRA toolkit</li> <li>Avec l'outil lancer la ligne de commande :  <code>prefetch --option-file path/to/SraAccList.csv -O path/to/output/folder</code>, cela permet de r\u00e9cup\u00e9rer les fichiers .sra</li> </ul> <p>Warning, pour deux SRA (SRR15376509, SRR15376518) le message d'erreur suivant est renvoy\u00e9 : <pre><code>2024-08-19T10:10:23 prefetch.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'\n2024-08-19T10:10:23 prefetch.2.5.7 err: path not found while resolving tree within virtual file system module - 'SRR15376509' cannot be found.\n</code></pre> Pour palier \u00e0 cela, il faut se rendre directement sur la page du SRA via le navigateur de recherche du SRA Run Browser. Puis r\u00e9cup\u00e9rer dans la section Data access et la sous-section SRA archive data l'adresse http afin de faire un <code>wget</code>.</p>"},{"location":"training/analysis/rnaseq-training/#13-obtention-des-fastq-lies-aux-sra","title":"1.3. Obtention des FASTQ li\u00e9s aux SRA","text":"<ul> <li>Dans le dossier o\u00f9 il y a tous les dossiers SRA, rentrer la ligne de commande : <code>for dir in SRR*; do fastq-dump --split-3 --skip-technical --gzip \"$dir\"/\"$dir\".sra; done</code>, cela permet d'avoir les fichiers FASTQ paired-end _1 et _2 et unpaired compress\u00e9s (voir la figure ci-dessous provenant du HowTo de fasterq-dump qui est un fastq-dump plus rapide mais sans la possibilit\u00e9 de compresser directement les fichiers)</li> <li>Supprimer les dossiers SRA pour all\u00e9ger le volume donn\u00e9es</li> </ul> <p>Attention, apr\u00e8s cette \u00e9tape les _1 et _2 des noms des fichiers FASTQ ont \u00e9t\u00e9 renomm\u00e9s en _R1 et _R2.</p>"},{"location":"training/analysis/rnaseq-training/#2-telechargement-des-fichiers-dinterets-les-references","title":"2. T\u00e9l\u00e9chargement des fichiers d'int\u00e9r\u00eats : les r\u00e9f\u00e9rences","text":""},{"location":"training/analysis/rnaseq-training/#21-le-transcriptome-de-reference","title":"2.1. Le transcriptome de r\u00e9f\u00e9rence","text":"<p>Nous allons t\u00e9l\u00e9charger le transcriptome humain de r\u00e9f\u00e9rence depuis le genome assembl\u00e9 GRCh38 (\u00e9tant \u00e0 ce jour la derni\u00e8re version).</p> <ul> <li>Aller sur la page du g\u00e9nome assembl\u00e9</li> <li>Cliquer sur l'onglet FTP</li> <li>Une liste d'Index of /genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14 sera propos\u00e9e (https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/)</li> <li>Choisir GCF_000001405.40_GRCh38.p14_rna.fna.gz</li> </ul>"},{"location":"training/analysis/rnaseq-training/#22-le-genome-de-reference","title":"2.2. Le g\u00e9nome de r\u00e9f\u00e9rence","text":"<p>Tout comme le transcriptome de r\u00e9f\u00e9rence, nous allons \u00e9galement prendre en possession le g\u00e9nome humain de r\u00e9f\u00e9rence.</p> <ul> <li>Aller sur la page du g\u00e9nome assembl\u00e9 GRCh38</li> <li>S\u00e9lectionner l'onglet FTP</li> <li>Une liste d'Index of /genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14 sera propos\u00e9e (https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/)</li> <li>Choisir GCF_000001405.40_GRCh38.p14_genomic.fna.gz</li> </ul>"},{"location":"training/analysis/rnaseq-training/#23-le-gtf","title":"2.3. Le GTF","text":"<p>Nous allons r\u00e9cup\u00e9rer les annotations g\u00e9nomiques du g\u00e9nome humain.</p> <ul> <li>Aller sur la page du g\u00e9nome assembl\u00e9 GRCh38</li> <li>S\u00e9lectionner l'onglet FTP</li> <li>Une liste d'Index of /genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14 sera propos\u00e9e (https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/)</li> <li>Choisir GCF_000001405.40_GRCh38.p14_genomic.gtf.gz</li> </ul>"},{"location":"training/analysis/rnaseq-training/#3-preparation-des-lectures","title":"3. Pr\u00e9paration des lectures","text":""},{"location":"training/analysis/rnaseq-training/#31-inference-du-strandedness","title":"3.1. Inf\u00e9rence du strandedness","text":"<p>Nous allons d\u00e9terminer les sp\u00e9cifit\u00e9s des librairies avec Salmon (v1.10.1) et le transcriptome de r\u00e9f\u00e9rence pour pouvoir renseigner correctement les param\u00e8tres d'outils. Puisque les donn\u00e9es ont \u00e9t\u00e9 s\u00e9quenc\u00e9es au m\u00eame moment par le m\u00eame s\u00e9quenceur avec la m\u00eame pr\u00e9paration de librairie, nous n'avons pas besoin d'effectuer cette manipulation pour chaque SRA. Voici les lignes de commande :  <pre><code>WORKDIR=path/of/work/directory\ngunzip \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_rna.fna.gz\n\n# Index human transcriptome\nsalmon index -t \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_rna.fna -i \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_rna.index -k 31\n\n# Run quant for having librarie type\nsalmon quant -i \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_rna.index -l A -1 \"$WORKDIR\"/SRR15376509_R1.fastq.gz -2 \"$WORKDIR\"/SRR15376509_R2.fastq.gz --validateMappings -o \"$WORKDIR\"/salmon_for_libtype \n\ngzip \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_rna.fna\n</code></pre></p> <p>Ici, l'option :</p> <ul> <li><code>-l</code> permet de renseigner le type de librairie. En informant <code>A</code>, la d\u00e9tection se fait automatiquement !</li> </ul> <p>Ce qui est important lors du lancement de salmon quant, c'est de bien regarder les sorties terminales (ou le log si vous les avez redirig\u00e9es) notamment la ligne o\u00f9 il est indiqu\u00e9e :  [date] <code>[jointLog] [info] Automatically detected most likely library type as</code> [libtype]. Dans notre cas, voici la ligne obtenue : <code>[2024-08-22 11:45:41.747] [jointLog] [info] Automatically detected most likely library type as ISR</code>.</p> <p>Ainsi, nos librairies sont <code>ISR</code>. De ce fait, nous pouvons dire que nos lectures sont fr-firststrand.</p>"},{"location":"training/analysis/rnaseq-training/#32-controle-qualite-des-lectures-avant-trimming","title":"3.2. Contr\u00f4le qualit\u00e9 des lectures avant trimming","text":"<p>Avant de d\u00e9buter les analyses des lectures, nous allons r\u00e9aliser un contr\u00f4le qualit\u00e9 des lectures. Pour ce faire, FastQC (v0.11.9) et MultiQC (v1.9) sont utilis\u00e9s. FastQC permet de faire un rapport contr\u00f4le qualit\u00e9 sur chacun des fichiers FASTQ l\u00e0 o\u00f9 MultiQC permet de regrouper tous les rapports en un. Voici les lignes de commande : <pre><code>mkdir \"$WORKDIR\"/data_qc\nmkdir \"$WORKDIR\"/data_qc/qc_before_trimming\nfastqc \"$WORKDIR\"/*fastq* -t 16 -o \"$WORKDIR\"/data_qc/qc_before_trimming\nmultiqc -i \"Human RNAseq\" \\\n        -b \"Quality control report before trimming step\" \\\n        -n RNAseq_wo_trimming_report \\\n        -o \"$WORKDIR\"/data_qc/qc_before_trimming \\\n        \"$WORKDIR\"/data_qc/qc_before_trimming/*fastq* \n</code></pre> Ici, l'option :</p> <ul> <li><code>-t</code> permet de d\u00e9terminer le nombre de threads</li> <li><code>-i</code> de caract\u00e9riser le titre du raport MultiQC</li> <li><code>-b</code> le sous-titre du raport MultiQC</li> <li><code>-n</code> le nom du fichier contenant le raport MultiQC</li> </ul>"},{"location":"training/analysis/rnaseq-training/#33-trimming-des-lectures","title":"3.3. Trimming des lectures","text":"<p>Dans le but d'avoir des lectures viables pour les analyses, nous effectuons un trimming. Cette \u00e9tape est essentielle car elle permet l'\u00e9limination des adaptateurs et les portions de lectures de mauvaise qualit\u00e9. Nous utilisons fastp (v0.20.1) comme outil qui permet de faire le trimming des adaptateurs, le filtre de qualit\u00e9 mais aussi pas mal de choses de fa\u00e7on tr\u00e8s rapide.  <pre><code># Declare a array with all samples names\ndeclare -a SAMPLES\nSAMPLES=(\n    'Name_sample_1'\n    'Name_sample_2'\n    'Name_sample_3'\n)\n\nTHREADS=16\n\nmkdir \"$WORKDIR\"/data_trimmed\nmkdir \"$WORKDIR\"/data_trimmed/fastp_report\n\n# For each samples names in the array\nfor i in ${!SAMPLES[@]}\ndo\n    echo -e \"*---------- TRIMMING STEP WITH FASTP : ${SAMPLES[$i]}\"\n    # Make fastp\n    fastp -i \"$WORKDIR\"/\"${SAMPLES[$i]}\"_R1.fastq.gz \\\n          -o \"$WORKDIR\"/data_trimmed/\"${SAMPLES[$i]}\"_R1.trim.fastq.gz \\\n          -I \"$WORKDIR\"/\"${SAMPLES[$i]}\"_R2.fastq.gz \\\n          -O \"$WORKDIR\"/data_trimmed/\"${SAMPLES[$i]}\"_R2.trim.fastq.gz \\\n          --unpaired1 \"$WORKDIR\"/data_trimmed/\"${SAMPLES[$i]}\"_R1_unpaired.trim.fastq.gz \\\n          --unpaired2 \"$WORKDIR\"/data_trimmed/\"${SAMPLES[$i]}\"_R2_unpaired.trim.fastq.gz \\\n          --detect_adapter_for_pe \\\n          -j \"$WORKDIR\"/data_trimmed/fastp_report/\"${SAMPLES[$i]}\"_fastp.json \\\n          -h \"$WORKDIR\"/data_trimmed/fastp_report/\"${SAMPLES[$i]}\".html \\\n          -R \"fastp report for ${SAMPLES[$i]}\" \\\n          -w \"$THREADS\" \\\n          --cut_right\ndone\n</code></pre></p> <p>Ici, l'option :</p> <ul> <li><code>-i</code> / <code>-I</code> permet de renseigner les fichiers FASTQ d'entr\u00e9e</li> <li><code>-o</code> / <code>-O</code> permet de renseigner les fichiers FASTQ de sortie. NB : si un <code>.gz</code> est ajout\u00e9 \u00e0 la fin du nom du fichier, il est alors automatiquement compress\u00e9</li> <li><code>--unpaired1</code> / <code>--unpaired2</code> permet de renseigner les fichiers FASTQ de sortie unpaired.</li> <li><code>--detect_adapter_for_pe</code> pour activer la d\u00e9tection automatique de la s\u00e9quence d'adaptateurs</li> <li><code>-j</code> pour renommer le rapport JSON </li> <li><code>-h</code> pour renommer le rapport HTML</li> <li><code>-R</code> pour red\u00e9finir le titre du rapport  </li> <li><code>-w</code> caract\u00e9rise le nombre de threads \u00e0 utiliser</li> <li><code>--cut_right</code> permet de d\u00e9placez une fen\u00eatre glissante d'avant en arri\u00e8re et si une fen\u00eatre avec une qualit\u00e9 moyenne &lt; threshold est rencontr\u00e9e, la lecture est coup\u00e9e \u00e0 partir de la fen\u00eatre. La taille de la fen\u00eatre et le threshold de qualit\u00e9 sont conserv\u00e9s par d\u00e9faut, soit 4 et 20. Cette option est similaire \u00e0 <code>SLIDINGWINDOW:4:20</code> de Trimmomatic.</li> </ul>"},{"location":"training/analysis/rnaseq-training/#34-controle-qualite-des-lectures-apres-trimming","title":"3.4. Contr\u00f4le qualit\u00e9 des lectures apr\u00e8s trimming","text":"<p>Pour voir si le trimming s'est bien pass\u00e9, nous r\u00e9alisons un contr\u00f4le qualit\u00e9 post-trimming. De la m\u00eame fa\u00e7on que pr\u00e9cedemment, FastQC et MultiQC sont utilis\u00e9s. <pre><code>WORKDIR=path/of/work/directory\nmkdir \"$WORKDIR\"/data_qc/qc_after_trimming\nfastqc \"$WORKDIR\"/data_trimmed/*fastq* -t 16 -o \"$WORKDIR\"/data_qc/qc_after_trimming\nmultiqc -i \"Human RNAseq\" \\\n        -b \"Quality control report after trimming step\" \\\n        -n RNAseq_trimming_report \\\n        -o \"$WORKDIR\"/data_qc/qc_after_trimming \\\n        \"$WORKDIR\"/data_qc/qc_after_trimming/*fastq* \n</code></pre></p> <p>Egalement, pour rassembler tous les logs de fastp en un seul, nous lan\u00e7ons MultiQC sur les fichiers de sortie JSON :  <pre><code>multiqc -i \"Human RNAseq\" \\\n        -b \"Trimming report\" \\\n        -n RNAseq_fastp_report \\\n        -o \"$WORKDIR\"/data_trimmed/fastp_report \\\n        \"$WORKDIR\"/data_trimmed/fastp_report/*.json\n</code></pre> Attention, il faut bien que le pattern fastp apparaisse dans le nom des fichiers JSON de fastp pour que MultiQC marche.</p>"},{"location":"training/analysis/rnaseq-training/#4-alignement-des-lectures-viables","title":"4. Alignement des lectures viables","text":""},{"location":"training/analysis/rnaseq-training/#41-indexation-du-genome-de-reference","title":"4.1. Indexation du g\u00e9nome de r\u00e9f\u00e9rence","text":"<p>Avant d'aligner, il est essentiel d'indexer le g\u00e9nome de r\u00e9f\u00e9rence. Nous allons utiliser dans ce cas, mais \u00e9galement pour l'alignement plus tard, HiSat2 (v2.2.1).</p> <p>HiSat2 index le g\u00e9nome avec un algorithme qui permet de faire un compromis entre le temps d'ex\u00e9cution et l'allocation de la m\u00e9moire. Le gros avantage est qu'il recherche automatiquement les param\u00e8tres pour aboutir \u00e0 cet objectif. </p> <p>HiSat2 peut prendre en entr\u00e9e le g\u00e9nome ou le transcriptome de r\u00e9f\u00e9rence. Mais, nous utiliserons le g\u00e9nome de r\u00e9f\u00e9rence pour \u00e9viter des alignements discordants. En effet, avec le transcriptome de r\u00e9f\u00e9rence, et notamment avec la pr\u00e9sence des isoformes, il peut y avoir des multi-alignements et donc cr\u00e9er des discordances dans la quantification (sous-estimer ou sur-estimer un transcript) et dans l'assemblage de novo.</p> <pre><code>gunzip \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_genomic.fna.gz\nmkdir \"$WORKDIR\"/hisat2_index\n\n# Build genome index\nhisat2-build -p 16 -f \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_genomic.fna \"$WORKDIR\"/hisat2_index/GCF_000001405.40_GRCh38.p14_genomic\n\ngzip \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_genomic.fna\n</code></pre> <p>Ici, l'option :</p> <ul> <li><code>-p</code> indique le nombre de threads \u00e0 utiliser </li> <li><code>-f</code> indique que la r\u00e9f\u00e9rence \u00e0 indexer est un fichier FASTA</li> </ul>"},{"location":"training/analysis/rnaseq-training/#42-alignement-contre-le-genome-indexe","title":"4.2. Alignement contre le g\u00e9nome index\u00e9","text":"<p>Ici toujours, nous allons utiliser HiSat2 et le g\u00e9nome index\u00e9 pr\u00e9alablement pour pouvoir r\u00e9aliser l'alignement des lectures trimm\u00e9es contre ce dernier. Une fois le fichier d'alignement g\u00e9n\u00e9r\u00e9, nous trions les alignements dans l'ordre de position nucl\u00e9otidique et compressons le fichier (de SAM vers BAM) avec SAMtools (v1.18) Le fait de trier nos alignements permet de poursuivre les analyses. Pour ce qui est de la compression, cela donne la possibilit\u00e9 de gagner en espace m\u00e9moire.</p> <pre><code># Declare a array with all samples names\ndeclare -a SAMPLES\nSAMPLES=(\n    'Name_sample_1'\n    'Name_sample_2'\n    'Name_sample_3'\n)\n\nTHREADS=16\n\nmkdir \"$WORKDIR\"/data_aligned\nmkdir \"$WORKDIR\"/data_aligned/hisat2_report\nfor i in ${!SAMPLES[@]}\ndo\n    echo -e \"*---------- ALIGN WITH HISAT2 : ${SAMPLES[$i]}\"\n    hisat2 -x \"$WORKDIR\"/hisat2_index/GCF_000001405.40_GRCh38.p14_genomic \\\\\n           -1 \"$WORKDIR\"/data_trimmed/\"${SAMPLES[$i]}\"_R1.trim.fastq.gz \\\\\n           -2 \"$WORKDIR\"/data_trimmed/\"${SAMPLES[$i]}\"_R2.trim.fastq.gz \\\\\n           -U \"$WORKDIR\"/data_trimmed/\"${SAMPLES[$i]}\"_R1_unpaired.trim.fastq.gz,\"$WORKDIR\"/data_trimmed/\"${SAMPLES[$i]}\"_R2_unpaired.trim.fastq.gz \\\\\n           -S \"$WORKDIR\"/data_aligned/\"${SAMPLES[$i]}\".sam \\\\\n           --rna-strandness RF \\\\\n           --downstream-transcriptome-assembly \\\\\n           --summary-file \"$WORKDIR\"/data_aligned/hisat2_report/\"${SAMPLES[$i]}\".hisat2.txt \\\\\n           -p \"$THREADS\"\n\n    echo -e \"*---------- SORT AND COMPRESS WITH SAMTOOLS : ${SAMPLES[$i]}\"\n    samtools sort \"$WORKDIR\"/data_aligned/\"${SAMPLES[$i]}\".sam -@ \"$THREADS\" -o \"$WORKDIR\"/data_aligned/\"${SAMPLES[$i]}\".sort.bam -O bam\n\n    rm \"$WORKDIR\"/data_aligned/\"${SAMPLES[$i]}\".sam\ndone\n</code></pre> <p>Ici, l'option :</p> <ul> <li><code>-x</code> permet de renseigner les noms des fichiers index  </li> <li><code>-1</code> et <code>-2</code> indique les fichiers FASTQ R1 et R2 des lectures pair\u00e9es</li> <li><code>-U</code> indique les fichiers FASTQ R1 et R2 des lectures non pair\u00e9es</li> <li><code>-S</code> d\u00e9signe le fichier SAM contenant les alignements \u00e0 cr\u00e9er </li> <li><code>--rna-strandness</code> renseigne le type de librairie des lectures</li> <li><code>--downstream-transcriptome-assembly</code> est une option utile pour l'assemblage car elle permet de conserver les lectures avec un long ancrage</li> <li><code>-p</code> d\u00e9termine le nombre de threads \u00e0 utiliser</li> </ul>"},{"location":"training/analysis/rnaseq-training/#5-assemblage-des-transcriptomes","title":"5. Assemblage des transcriptomes","text":""},{"location":"training/analysis/rnaseq-training/#51-preparation-du-gtfgff","title":"5.1. Pr\u00e9paration du GTF/GFF","text":"<p>Lorsque nous allons assembler le transcriptome, nous allons avoir besoin du GTF pour guider l'assemblage. Mais avant de faire cela, il est important de v\u00e9rifier notre fichier GTF et de le corriger si jamais. Pour cela, nous utilisons AGAT (v1.4.0) un outil sp\u00e9cialis\u00e9 dans les GTF/GFF.</p> <p><pre><code>agat_convert_sp_gxf2gxf.pl -g \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_genomic.gtf.gz -o \"$WORKDIR\"/GCF_000001405.40_GRCh38.p14_genomic.agat.gff\n</code></pre> Par d\u00e9faut, le fichier de sortie est au format GFF mais il est possible de changer les configs. Pour la suite, ce n'est pas g\u00e9nant que le fichier soit un GFF.</p>"},{"location":"training/analysis/rnaseq-training/#52-assemblage-guide","title":"5.2. Assemblage guid\u00e9","text":"<p>Les alignements ainsi que le GFF sont pr\u00eats, nous allons donc r\u00e9aliser les assemblages des transcriptomes. Pour le faire, nous utiliserons l'outil StringTie (v2.2.3) qui est un assembleur rapide et efficace d'alignements RNAseq en transcripts potentiels.</p> <pre><code># Declare a array with all samples names\ndeclare -a SAMPLES\nSAMPLES=(\n    'Name_sample_1'\n    'Name_sample_2'\n    'Name_sample_3'\n)\n\nTHREADS=16\n\nmkdir -p \"$WORKDIR\"/data_assembly\n\necho -e \"*---------- ASSEMBLY SAMPLES\"\nfor i in ${!SAMPLES[@]}\ndo\n    echo -e \"*---------- ASSEMBLY WITH STRINGTIE : ${SAMPLES[$i]}\"\n    stringtie -G \"$DIRREFS\"/GCF_000001405.40_GRCh38.p14_genomic.agat.gff -o \"$WORKDIR\"/data_assembly/\"${SAMPLES[$i]}\".gtf -p \"$THREADS\" --rf \"$WORKDIR\"/data_aligned/\"${SAMPLES[$i]}\".sort.bam\ndone\n</code></pre> <p>L'option : </p> <ul> <li><code>-G</code> indique un fichier GFF (GFF3) contenant des annotations de g\u00e8nes (comme les exons et les g\u00e8nes) qui vont servir de guide pour l'assemblage. Cela permet \u00e0 StringTie de mieux assembler les transcrits en se basant sur des annotations connues.</li> <li><code>--rf</code> pour informer que les donn\u00e9es sont fr-firststrand</li> <li><code>-p</code> pour le nombre de threads</li> </ul>"},{"location":"training/analysis/rnaseq-training/#53-creation-du-transcriptome-global","title":"5.3. Cr\u00e9ation du transcriptome global","text":"<p>Pour chacun des \u00e9chantillons, nous avons assembl\u00e9 les transcriptomes avec les lectures. Maintenant, nous allons construire le transcriptome global en le g\u00e9n\u00e9rant avec l'ensemble non redondant des transcrits observ\u00e9s dans les \u00e9chantillons. Pour effectuer cela, nous allons encore une fois utilis\u00e9 StringTie mais le mode <code>--merge</code>. Ce mode prends en entr\u00e9e une liste de GTF et renvoie un seul et unique GTF.</p> <pre><code>stringtie --merge -G \"$DIRREFS\"/GCF_000001405.40_GRCh38.p14_genomic.agat.gff -o \"$WORKDIR\"/merged_transcriptomes.gtf \"$WORKDIR\"/data_assembly/*.gtf\n</code></pre>"},{"location":"training/analysis/rnaseq-training/#54-comparaison-du-transcriptome-global-avec-la-reference","title":"5.4. Comparaison du transcriptome global avec la r\u00e9f\u00e9rence","text":"<p>Nous allons comparer le transcriptome global avec le GFF de r\u00e9f\u00e9rence afin de voir les correspondances et discordances. Dans ce cas, nous allons utiliser l'outil GffCompare(v0.12.6).</p> <pre><code>gffcompare -r \"$DIRREFS\"/GCF_000001405.40_GRCh38.p14_genomic.agat.gff \"$WORKDIR\"/merged_transcriptomes.gtf -o gffcompare_ref_vs_merged_transcriptome\n</code></pre> <p>Ici, l'option : </p> <ul> <li><code>-r</code> indique le GFF de r\u00e9f\u00e9rence</li> <li><code>-o</code> le pr\u00e9fix \u00e0 renseigner pour les fichiers de sortie</li> </ul>"},{"location":"training/analysis/rnaseq-training/#6-quantification-des-transcrits-et-des-genes","title":"6. Quantification des transcrits et des g\u00e8nes","text":"<p>Toujours avec StringTie, nous allons estimer les abondances des transcripts et g\u00e9n\u00e9rer un tableau avec l'abondance des g\u00e8nes. Ainsi, nous allons donner en entr\u00e9e les alignements tri\u00e9es que nous avions produit avec la combinaison HiSat2 - SAMtools pr\u00e9c\u00e9demment et le transcriptome que nous venons de cr\u00e9er afin d'avoir pour chacun des \u00e9chantillons les TPM.</p> <pre><code>declare -a SAMPLES\nSAMPLES=(\n    'Name_sample_1'\n    'Name_sample_2'\n    'Name_sample_3'\n)\n\nTHREADS=16\n\nmkdir \"$WORKDIR\"/transcript_abundances\n\necho -e \"*---------- TRANSCRIPT ABUNDANCES\"\nfor i in ${!SAMPLES[@]}\ndo\n    echo -e \"*---------- TRANSCRIPT ABUNDANCES WITH STRINGTIE : ${SAMPLES[$i]}\"\n    mkdir \"$WORKDIR\"/transcript_abundances/sample_\"${SAMPLES[$i]}\"\n    stringtie -e -A \"$WORKDIR\"/transcript_abundances/sample_\"${SAMPLES[$i]}\"/\"${SAMPLES[$i]}\".tsv -G \"$WORKDIR\"/merged_transcriptomes.gtf -o \"$WORKDIR\"/transcript_abundances/sample_\"${SAMPLES[$i]}\"/\"${SAMPLES[$i]}\".gtf -p \"$THREADS\" --rf \"$WORKDIR\"/data_aligned/\"${SAMPLES[$i]}\".sort.bam\ndone\n</code></pre> <p>Ici, l'option : </p> <ul> <li><code>-e</code> indique \u00e0 l'outil d'estimer l'expression</li> <li><code>-A</code> pour dire que nous voulons le tableau avec l'abondance des g\u00e8nes</li> </ul> <p>En sortie de l'option <code>-e</code>, nous obtenons un GTF, format que nous connaissons, avec tous les transcrits et leur TPM associ\u00e9. Avec l'option <code>-A</code>, c'est un tableau tabul\u00e9 avec l'abondance des g\u00e8nes sous forme de TPM :</p> <p></p> <p>Il faut noter que les TPM des g\u00e8nes sont la somme des TPM des transcripts les constituants. Aussi, dans la colonne Gene Name, le nom du g\u00e8ne est report\u00e9 si connu. S'il n'est pas report\u00e9, c'est que : - le g\u00e8ne pr\u00e9sente au moins un nouveau transcripts que va au del\u00e0 du start et du end du g\u00e8ne connu - la r\u00e9gion est non annot\u00e9e - il y a absence de correspondance</p> <p>Egalement, il peut y avoir une redondance de Gene Name car comme nous avons pris la version patch\u00e9e du g\u00e9nome humain de r\u00e9f\u00e9rence le g\u00e8ne peut \u00eatre pr\u00e9sent sur un chromosome et sur un scaffold. Voici un exemple :</p> <p></p>"},{"location":"training/analysis/rnaseq-training/#7-analyse-de-lexpression-differentielle","title":"7. Analyse de l'expression diff\u00e9rentielle","text":""},{"location":"training/analysis/rnaseq-training/#71-creation-des-matrices-de-comptes","title":"7.1. Cr\u00e9ation des matrices de comptes","text":"<p>Nous avons pr\u00e9c\u00e9demment estim\u00e9 les transcripts. Nous allons par la suite utiliser le package R DESeq2 pour r\u00e9aliser l'expression diff\u00e9rentielle. Pour ce faire, nous devons d'abord transformer les sorties d'estimation d'abondance en entr\u00e9e DESeq2 \u00e0 l'aide du script python <code>prepDE.py</code> fourni par Stringtie.</p> <pre><code>python prepDE.py3 -i \"$WORKDIR\"/transcript_abundances -p sample -g \"$WORKDIR\"/transcript_abundances/prepDE_gene_count_matrix.csv -t \"$WORKDIR\"/transcript_abundances/prepDE_transcript_count_matrix.csv\n</code></pre> <p>L'option : </p> <ul> <li><code>-i</code> renseigne le dossier o\u00f9 il faut aller chercher les estimations</li> <li><code>-p</code> indique le pattern des sous-dossier o\u00f9 se trouve les fichiers GTF avec les estimations</li> <li><code>-g</code> et <code>-t</code> servent juste \u00e0 donner des noms aux fichiers de sorties CSV</li> </ul> <p>A la fin de cette ligne de commande, nous aurons deux fichiers CSV pr\u00eats \u00e0 \u00eatre utilis\u00e9s par DESeq2 : l'un relatant les comptes pour les transcrits et l'un pour les g\u00e8nes. Il est important de noter, comme nous l'indique Stringtie, pour le compte des transcrits : </p> <p>prepDE.py derives hypothetical read counts for each transcript from the coverage values estimated by StringTie for each transcript, by using this simple formula: reads_per_transcript = coverage * transcript_len / read_len </p> <p>Les comptes des g\u00e8nes, quant \u00e0 eux, correspondent \u00e0 la somme des <code>reads_per_transcript</code> les constituants. </p>"},{"location":"training/analysis/rnaseq-training/#72-preparation-de-la-matrice-dinformations","title":"7.2. Pr\u00e9paration de la matrice d'informations","text":"<p>Les comptes sont pr\u00eats \u00e0 \u00eatre donn\u00e9s \u00e0 DESeq2, mais il manque encore une chose : la matrice des informations sur les \u00e9chantillons. Celle-ci est indispensable dans notre analyse d'expression diff\u00e9rencielle. Nous allons donc cr\u00e9er un fichier au format tabul\u00e9 que nous appelerons pheno_data.csv.</p> <p>Voici quelques lignes du fichier :  <pre><code>sample  time    condition   selection   replica\nsample_D2_mock_noSel_rep43  S0  mock    noSel   rep43\nsample_D2_mock_noSel_rep41  S0  mock    noSel   rep41\nsample_D2_mock_noSel_rep33  S0  mock    noSel   rep33\nsample_D2_mock_noSel_rep32  S0  mock    noSel   rep32\n</code></pre></p>"},{"location":"training/analysis/rnaseq-training/#73-lanalyse-dexpression-differencielle","title":"7.3. L'analyse d'expression diff\u00e9rencielle","text":"<p>Tous les fichiers sont pr\u00eats : </p> <ul> <li>le fichier avec les comptes </li> <li>le fichier avec les informations</li> </ul> <p>Dor\u00e9navant, tout se fera sous R avec la librairie DESeq2. </p> <pre><code># Import libraries\nlibrary(DESeq2)\nlibrary(\"BiocParallel\") # librarie to parallelize analysis\nregister(MulticoreParam(4)) # number of cpu\n\n# Import gene count\ncountData &lt;- read.csv(\"prepDE_gene_count_matrix.csv\", row.names=\"gene_id\")\n\n# Remove last line with total values\ncountData &lt;- countData[-nrow(countData),]\n\n# Keep line where isn't only 0 values\ncountData &lt;- countData[rowSums(countData != 0) &gt; 0, ]\n\n# Change the dataframe into a matrix\ncountData &lt;- as.matrix(countData)\n\n# Import informations about data\ncolData &lt;- read.csv(\"pheno_data.csv\", sep=\",\", row.names=1)\n\n# Check\nall(rownames(colData) %in% colnames(countData))\ncountData &lt;- countData[, rownames(colData)]\nall(rownames(colData) == colnames(countData))\n\n# Create dds object\nddsCond &lt;- DESeqDataSetFromMatrix(countData = countData, colData = colData, design = ~ condition)\n\n# Filtering counts\nsmallestGroupSize &lt;- 6 #choose the minimum redondance of a vector of informations\nkeep &lt;- rowSums(counts(ddsCond) &gt;= 10) &gt;= smallestGroupSize\nddsCond &lt;- ddsCond[keep,]\n\n# Calculate the variance stabilizing transformation\nvsdCond &lt;- vst(ddsCond, blind=FALSE)\n\n# PCA on vst results\npdf(\"pca_ddscond_vst.pdf\")\nplotPCA(vsdCond, intgroup = c(\"time\"))\ndev.off()\n\n# Run the default analysis of DESeq2\nddsCond &lt;- DESeq(ddsCond, parallel=TRUE)\n\n# Save dds object\nsaveRDS(ddsCond, \"DESeqDataSet.ddsTimeCond.rds\")\n\n# View names of results comparisons\nresultsNames(ddsCond)\n# [1] \"Intercept\"                  \"condition_mock_vs_empty\"   \n# [3] \"condition_shble1_vs_empty\"  \"condition_shble10_vs_empty\"\n# [5] \"condition_shble2_vs_empty\"  \"condition_shble3_vs_empty\" \n# [7] \"condition_shble4_vs_empty\"  \"condition_shble5_vs_empty\" \n# [9] \"condition_shble6_vs_empty\"\n\n# Create results table of dds object\nresCondMockEmpty &lt;- results(ddsCond, name=\"condition_mock_vs_empty\")\nresCondSh1Empty &lt;- results(ddsCond, name=\"condition_shble1_vs_empty\")\nresCondSh2Empty &lt;- results(ddsCond, name=\"condition_shble2_vs_empty\")\nresCondSh3Empty &lt;- results(ddsCond, name=\"condition_shble3_vs_empty\")\nresCondSh4Empty &lt;- results(ddsCond, name=\"condition_shble4_vs_empty\")\nresCondSh5Empty &lt;- results(ddsCond, name=\"condition_shble5_vs_empty\")\nresCondSh6Empty &lt;- results(ddsCond, name=\"condition_shble6_vs_empty\")\nresCondSh10Empty &lt;- results(ddsCond, name=\"condition_shble10_vs_empty\")\n</code></pre> <p>Une fois les r\u00e9sultats cr\u00e9\u00e9s, vous pouvez les enregistrer sous format .csv sur votre ordinateur.</p>"},{"location":"training/dev/mkdocs/","title":"Cr\u00e9er un site statique avec MkDocs","text":"<p>MkDocs est un g\u00e9n\u00e9rateur de site statique destin\u00e9 \u00e0 la cr\u00e9ation de documentation technique, principalement en utilisant des fichiers Markdown. Il est particuli\u00e8rement populaire dans les communaut\u00e9s de d\u00e9veloppeurs et dans les projets open-source pour cr\u00e9er des sites web de documentation faciles \u00e0 maintenir et \u00e0 d\u00e9ployer, notamment sur Github.</p> <p>Ce site a \u00e9t\u00e9 cr\u00e9\u00e9 en MkDocs !</p>"},{"location":"training/dev/mkdocs/#installation","title":"Installation","text":"<p>Pour installer MkDocs, nous allons utiliser conda. </p> <p>Dans un terminal :  <pre><code># Create a new env \nconda create -n mkdocs\n\n# Activate the new env\nconda activate mkdocs\n\n# Check if python3 is properly installed\npython3 --version\n\n# Install pip package manager if it's necessary\nsudo apt install python3-pip\n\n# Install mkdocs\npip install mkdocs\n\n# Install some plugins\npip install mkdocs-material mkdocs-material-extensions\n</code></pre></p>"},{"location":"training/dev/mkdocs/#creer-un-projet","title":"Cr\u00e9er un projet","text":"<p>Nous allons cr\u00e9er en premier un r\u00e9pertoire de travail</p> <pre><code>mkdir mkdocs-website\n</code></pre> <p>A l'int\u00e9rieur du r\u00e9pertoire de travail, nous allons initialiser le projet : <pre><code>mkdocs new .\n</code></pre></p> <p>Cette derni\u00e8re commande va cr\u00e9er :</p> <ul> <li> <p>un fichier mkdocs.yml dont voici le contenu :  <pre><code>site_name: My Docs\n</code></pre></p> </li> <li> <p>un dossier docs avec \u00e0 l'int\u00e9rieur un fichier index.md dont voici le contenu :  <pre><code># Welcome to MkDocs\n\nFor full documentation visit [mkdocs.org](https://www.mkdocs.org).\n\n## Commands\n\n* `mkdocs new [dir-name]` - Create a new project.\n* `mkdocs serve` - Start the live-reloading docs server.\n* `mkdocs build` - Build the documentation site.\n* `mkdocs -h` - Print help message and exit.\n\n## Project layout\n\n    mkdocs.yml    # The configuration file.\n    docs/\n        index.md  # The documentation homepage.\n        ...       # Other markdown pages, images and other files.\n</code></pre></p> </li> </ul> <p>Ainsi notre projet a pour structure : <pre><code>mkdocs-website/\n\u251c\u2500\u2500 docs/\n\u2502   \u2514\u2500\u2500 index.md              # La page d'accueil du site\n\u2514\u2500\u2500 mkdocs.yml                # Fichier de configuration du site\n</code></pre></p>"},{"location":"training/dev/mkdocs/#modifier-le-contenu-du-site","title":"Modifier le contenu du site","text":"<p>Maitenant que tout est initialis\u00e9, nous allons cr\u00e9er notre site web \u00e0 proprement parl\u00e9.</p> <p>Pour \u00e7a, nous allons modifier le fichier de configuration et ajouter quelques lignes : <pre><code># Nom de votre site\nsite_name: mkdocs-website\n\n# Description facultative (utilis\u00e9e dans les m\u00e9tadonn\u00e9es et les moteurs de recherche)\nsite_description: \"Un site cr\u00e9\u00e9 avec MkDocs\"\n\n# Chemin du logo (optionnel, \u00e0 ajouter dans 'docs/' ou un sous-dossier 'images/')\n# logo: images/logo.png\n\n# Th\u00e8me Material (nous l'avons install\u00e9 avec `pip install mkdocs-material`)\ntheme:\n  name: material  # Le th\u00e8me utilis\u00e9 est \"Material\"\n  language: fr  # La langue du site est d\u00e9finie sur le fran\u00e7ais\n  # Liste des fonctionnalit\u00e9s suppl\u00e9mentaires \u00e0 activer dans le th\u00e8me\n  features:\n    - navigation.tabs  # Active les onglets de navigation pour une meilleure organisation\n    - navigation.expand  # Permet d'\u00e9tendre ou de r\u00e9duire les menus de navigation\n    - navigation.indexes  # Active l'indexation dans la navigation pour une meilleure structuration\n    - header.autohide  # Masque l'en-t\u00eate lorsque l'on fait d\u00e9filer la page\n\n  # Personnalisation de la palette de couleurs du site\n  palette:\n    - scheme: default  # Utilisation du sch\u00e9ma de couleurs par d\u00e9faut\n      primary: black  # Couleur principale, ici le noir pour l'en-t\u00eate\n      accent: blue  # Couleur d'accentuation, ici le bleu pour les liens\n      toggle:\n        icon: material/lightbulb-night-outline  # Ic\u00f4ne de mode sombre (ampoule \u00e9teinte). \n        name: Mode sombre  # Texte pour l'activation du mode sombre\n    - scheme: slate  # Un autre sch\u00e9ma de couleurs (Slate, une teinte grise)\n      primary: black  # Couleur principale (noir)\n      accent: blue  # Couleur d'accent (bleu)\n      toggle:\n        icon: material/lightbulb-outline  # Ic\u00f4ne de mode clair (ampoule allum\u00e9e)\n        name: Mode clair  # Texte pour l'activation du mode clair\n\n  # Liste des autres fonctionnalit\u00e9s \u00e0 activer\n  features:\n    - toc.follow  # Fait suivre le tableau des mati\u00e8res (TOC) avec le d\u00e9filement de la page\n    - toc.integrate  # Int\u00e8gre le tableau des mati\u00e8res dans le contenu de la page\n    - navigation.top  # Ajoute une barre de navigation en haut de la page\n    - content.code.copy  # Ajoute un bouton pour copier le code dans le presse-papier\n    - navigation.tabs  # Active \u00e0 nouveau les onglets de navigation\n    - search.highlight  # Met en surbrillance les r\u00e9sultats de recherche sur le site\n\n# Extensions Markdown (activent des fonctionnalit\u00e9s suppl\u00e9mentaires)\nmarkdown_extensions:\n  - tables          # Support avanc\u00e9 pour les tableaux\n  - toc             # Table des mati\u00e8res automatique\n  - codehilite      # Mise en surbrillance du code\n  - pymdownx.extra  # Collection d'extensions Markdown utiles\n  - pymdownx.snippets  # R\u00e9utilisation de fragments de code\n\n# Structure de la navigation (li\u00e9e aux fichiers Markdown dans le dossier `docs/`)\nnav:\n  - Accueil: index.md\n</code></pre></p> <p>Ensuite, nous allons modifier le fichier index.md : <pre><code># Bienvenue sur mon site\n\nVoici un site fait en MkDocs !\n</code></pre></p>"},{"location":"training/dev/mkdocs/#modifier-la-structure-du-site","title":"Modifier la structure du site","text":"<p>Pour le moment, notre site web n'a qu'une seule page. Nous allons en ajouter dans de nouveaux onglets.</p> <p>Pour \u00e7a, nous allons cr\u00e9er et placer les nouvelles pages dans le dossier /docs \u00e0 l'int\u00e9rieur de nouveaux dossiers.  Voici la structure dor\u00e9navant de notre site :  <pre><code>mkdocs-website/\n\u2502\n\u251c\u2500\u2500 mkdocs.yml\n\u2502\n\u2514\u2500\u2500 docs/\n    \u251c\u2500\u2500 index.md\n    \u251c\u2500\u2500 onglet1/\n    \u2502   \u251c\u2500\u2500 page1.md\n    \u2502   \u2514\u2500\u2500 page2.md\n    \u251c\u2500\u2500 onglet2/\n    \u2502   \u251c\u2500\u2500 page3.md\n    \u2502   \u2514\u2500\u2500 sous-onglet/\n    \u2502       \u2514\u2500\u2500 page4.md\n</code></pre></p> <p>Dans le fichier mkdocs.yml, nous allons \u00e9tayer la partie nav afin de renseigner cette nouvelle structure :  <pre><code># Structure de la navigation (li\u00e9e aux fichiers Markdown dans le dossier `docs/`)\nnav:\n  - Accueil: index.md\n  - Onglet1 : \n    - Page1 : onglet1/page1.md\n    - Page2 : onglet1/page2.md\n  - Onglet2 : \n    - Page3 : onglet2/page3.md\n    - Sous-onglet :\n      - Page4 : onglet2/sous-onglet/page4.md\n</code></pre></p>"},{"location":"training/dev/mkdocs/#lancer-le-serveur-de-developpement","title":"Lancer le serveur de d\u00e9veloppement","text":"<p>Notre site est pr\u00eat. Nous allons donc dor\u00e9navant le visualiser localement.  Dans un terminal, il suffit de lancer dans le r\u00e9pertoire du projet au m\u00eame niveau que le fichier mkdocs.yml : <pre><code>mkdocs serve\n</code></pre></p> <p>Cela lance un serveur local \u00e0 l'adresse http://127.0.0.1:8000. Il est alors possible d'ouvrir un navigateur \u00e0 cette adresse pour voir \u00e0 quoi ressemble le site.</p> <p></p> <p></p> <p></p>"},{"location":"training/dev/mkdocs/#deployer-le-site-sur-github","title":"D\u00e9ployer le site sur GitHub","text":"<p>Nous avons vu notre site est comme nous le souhaitons en local. Maintenant, nous allons donc le d\u00e9ployer sur GitHub pour qu'il soit accessible \u00e0 toutes et tous.</p>"},{"location":"training/dev/mkdocs/#configurer-les-fichiers-locaux","title":"Configurer les fichiers locaux","text":"<p>En premier lieu, nous allons rajouter une ligne dans le fichier <code>mkdocs.yml</code>.  <pre><code># URL publique o\u00f9 le site est accessible apr\u00e8s d\u00e9ploiement\nsite_url: https://srh-bzd.github.io/mkdocs-website\n</code></pre></p> <p>Puis, nous allons cr\u00e9er un r\u00e9pertoire <code>.github</code> avec comme sous r\u00e9pertoire <code>workflows</code> \u00e0 la racine du projet <pre><code>mkdir -p .github/workflows\n</code></pre></p> <p>Dans le r\u00e9pertoire <code>workflows</code>, nous allons ajouter le fichier <code>ci.yml</code> dont le contenu est : <pre><code>name: Deploy MkDocs\n\non:\n  push:\n    branches:\n      - main # D\u00e9clenche l'action uniquement pour les commits pouss\u00e9s sur la branche main.\n\npermissions:\n  contents: write # N\u00e9cessaire pour publier sur GitHub Pages.\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n\n    steps:\n    # 1. V\u00e9rifier le code source.\n      - name: Checkout Code\n        uses: actions/checkout@v3\n\n    # 2. Configurer Python.\n      - name: Setup Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: 3.x\n\n    # 3. Installer les d\u00e9pendances.\n      - name: Install Dependencies\n        run: |\n          pip install mkdocs-material\n          pip install pymdown-extensions\n          pip install mkdocs-minify-plugin\n          pip install mkdocs-macros-plugin\n          pip install mkdocs-include-markdown-plugin\n\n    # 4. D\u00e9ployer avec MkDocs.\n      - name: Deploy to GitHub Pages\n        run: mkdocs gh-deploy --force\n</code></pre></p> <p>La structure du site devient de la forme : <pre><code>mkdocs-website/\n\u251c\u2500\u2500 docs/\n\u251c\u2500\u2500 .github/workflows\n|    \u2514\u2500\u2500 ci.yml\n\u2514\u2500\u2500 mkdocs.yml\n</code></pre></p>"},{"location":"training/dev/mkdocs/#configurer-le-repertoire-github","title":"Configurer le r\u00e9pertoire GitHub","text":"<p>Sur Git, nous allons cr\u00e9er un nouveau r\u00e9pertoire mkdocs-website. Assurez-vous que le r\u00e9pertoire est bien Public. Puis, nous allons ajouter tout notre r\u00e9pertoire de travail local sur Git. </p> <p>Une fois tout cela r\u00e9alis\u00e9, il est temps de d\u00e9ployer le site. Pour ce faire, dans Setting --&gt; Pages --&gt; Branch choisissez gh-pages et /(root) puis cliquez sur Save. </p> <p>Si tout s'est bien d\u00e9roul\u00e9, dans Code, \u00e0 c\u00f4t\u00e9 de votre nom Git et du dernier commit, apparaitra un check vert. </p> <p>Il est possible maintenant d'aller sur l'URL renseign\u00e9 dans le fichier mkdocs.yml</p>"},{"location":"training/visualization/venn/","title":"Visualiser des relations avec les diagrammes de Venn","text":"<p>Il arrive de vouloir observer les relations entre deux ou plusieurs ensembles. Ainsi, souvent, un diagramme de Venn est utilis\u00e9. Celui-ci montre toutes les relations logiques possibles.</p>"},{"location":"training/visualization/venn/#la-librairie-r-ggvenndiagram","title":"La librairie R ggVennDiagram","text":"<p>Pour dessiner les diagrammes, nous allons nous servir de la librairie R ggVennDiagram. C'est une librairie puissante qui utilise le syst\u00e8me graphique ggplot2. Elle permet de produire des diagrammes esth\u00e9tiques et personnalisables</p>"},{"location":"training/visualization/venn/#installation","title":"Installation","text":"<p>Pour l'installer et l'appeler voici les lignes de commande \u00e0 ex\u00e9cuter: <pre><code>install.packages(\"ggVennDiagram\")\n\nlibrary(ggVennDiagram)\n</code></pre></p>"},{"location":"training/visualization/venn/#preparer-les-donnees","title":"Pr\u00e9parer les donn\u00e9es","text":"<p>ggVennDiagram fonctionne avec des listes ou des ensembles. Voici deux exemples de donn\u00e9es : <pre><code>sets_text &lt;- list(\n  A = c(\"kanar\", \"sheval\", \"lapain\", \"ornitoraink\", \"chieng\"),\n  B = c(\"sheval\", \"ornitoraink\", \"kanar\", \"chieng\"),\n  C = c(\"kanar\", \"lapain\", \"chieng\", \"sheval\")\n)\n\nsets_numbers &lt;- list(\n  X = c(1, 2, 3, 4, 5),\n  Y = c(4, 5, 6, 7),\n  Z = c(5, 6, 8, 9)\n)\n</code></pre></p>"},{"location":"training/visualization/venn/#creation-des-diagrammes-de-venn","title":"Cr\u00e9ation des diagrammes de Venn","text":""},{"location":"training/visualization/venn/#diagramme-de-base","title":"Diagramme de base","text":"<p>Pour cr\u00e9er un diagramme de Venn simple, il suffit simplement de lancer : <pre><code>ggVennDiagram(sets_text)\n\nggVennDiagram(sets_numbers)\n\n# Pour afficher les graphiques c\u00f4te \u00e0 c\u00f4te comme ci-dessous\nlibrary(gridExtra)\ngrid.arrange(ggVennDiagram(sets_text), ggVennDiagram(sets_numbers), ncol=2)\n</code></pre> </p>"},{"location":"training/visualization/venn/#personnalisation-du-diagramme","title":"Personnalisation du diagramme","text":"<p>Il est possible de modifier deux - trois choses. Pour cela, il faut imp\u00e9rativement importer la librairie ggplot2 puis entrer les lignes de commande d'int\u00e9r\u00eats :  <pre><code>library(ggplot2)\n\nvenn_text &lt;- ggVennDiagram(sets_text, set_color = c(\"black\", \"orange\", \"skyblue\"), label = \"count\", label_alpha = 0) + \n  scale_fill_gradient(low=\"lightgrey\", high = \"white\") +\n  ggtitle(\"Diagramme de Venn d'ensembles avec texte\")\n\nvenn_numbers &lt;- ggVennDiagram(sets_numbers, set_color = c(\"purple\", \"red\", \"yellow\"), label = \"percent\", label_alpha = 0) + \n  scale_fill_gradient(low=\"lightgrey\", high = \"white\") +\n  ggtitle(\"Diagramme de Venn d'ensembles avec chiffres\")\n\ngrid.arrange(venn_text, venn_numbers, ncol=2)\n</code></pre></p> <p>Ici :</p> <ul> <li><code>set_color</code> premet de changer la couleur des cercles</li> <li><code>label = \"count\"</code> permet de n'afficher que les valeurs \u00e0 l'int\u00e9rieur des cercles. Il est possible de ne rien afficher avec <code>label = \"none\"</code>, les pourcentages uniquement avec <code>label = \"percent\"</code> et pourcentages et chiffres avec <code>label = \"both\"</code></li> <li><code>label_alpha = 0</code> donne la possibilit\u00e9 de rendre transparentes les \u00e9tiquettes du texte. 0 indique une transparence totale</li> <li><code>scale_fill_gradient</code> indique les couleurs \u00e0 utiliser pour remplir les zones du diagramme. <code>low</code>\u00a0pour les zones avec peu d'\u00e9l\u00e9ments et <code>high</code> pour les zones avec un grand nombre d'\u00e9l\u00e9ments</li> <li><code>ggtitle</code> permet d'ajouter un titre au graphique</li> </ul> <p></p>"},{"location":"training/visualization/venn/#nombre-de-sets","title":"Nombre de sets","text":"<p>Ce qui est int\u00e9ressant avec la librairie ggVennDiagram c'est qu'il est possible de repr\u00e9senter des diagrammes de Venn jusqu'\u00e0 7 ensembles (sets) ! </p> <p></p> <p>Au del\u00e0 de 7 ensembles (ou moins), la librairie offre un autre type de repr\u00e9sentation : l'upset plot. Avec une des listes utilis\u00e9e pr\u00e9cedemment :  <pre><code>ggVennDiagram(sets_text, force_upset = TRUE, order.set.by = \"name\", order.intersect.by = \"size\")\n</code></pre></p> <p>Ici :</p> <ul> <li><code>force_upset = TRUE,</code> force la g\u00e9n\u00e9ration d'un diagramme upset plot au lieu d'un diagramme de Venn classique</li> <li><code>order.set.by = \"name\"</code> d\u00e9fini que les ensembles doivent \u00eatre ordonn\u00e9es par ordre alphab\u00e9tique</li> <li><code>order.intersect.by = \"size\"</code> pour ordonner les ensembles par taille, c'est-\u00e0-dire par le nombre d'\u00e9l\u00e9ments qu\u2019ils contiennent</li> </ul> <p></p>"}]}